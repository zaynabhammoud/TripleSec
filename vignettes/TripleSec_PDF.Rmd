---
title: "TripleSec"
author:
  -name: Samantha Cramer
  email: samantha.cramer@protonmail.com
  affiliation: University of Augsburg
date: "`r Sys.Date()`"
output: pdf_document
vignette: >
  %\VignetteIndexEntry{TripleSec PDF Vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
  
  ```{r, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>")
```
## Introduction
In the day and age, where more data per patient arises and has to be evaluated, clinical support algorithms (CDS) are becoming more and more relevant for health care providers, providing them with a helping tool for sifting through data and suggesting further steps of treatment. The Triple Sec Algorithm is a clinical support algorithm for risk assessment of Alzheimers disease. It's goal is to categorize patients with neurological symptoms into three categories. These three categories, high risk, low risk and indiscriminate, represent the risk of the patient progressing to Alzheimer's disease, dependent on the given biomarker values. The categories are defined by cutoff values of the biomarkers. These cutoff values are calculated dependent on user defined risk-threshold and ratio of patients.

## Installation
## Preinstallation
TripleSec depends on one package. 
[readr](https://cran.r-project.org/web/packages/readr/index.html)

Please ensure to install the readr package before using the TripleSec package.


### Installation via GitHub
```{r setup, eval=FALSE}
require(readr)
install_github("zaynabhammoud/TripleSec")
library(TripleSec)
```

# Available Functions
## pruneTree
**calculate cutOff table for given data**

This function splits the given data table into training and test data. Then calls calCutOff for the training data and predictTree with the calculated cutOff values of calCutOff and the test data.
<br>The function requires the following arguments:

- **inputData** - The prepared input data. The data can be prepared via the function `prepareData(data, firstFeature, featureList)`
- **pHigh** - The high risk threshold
- **pLow** - The low risk threshold

The function pruneTree returns a variable result with a link to a table containing the average cutoff values for each feature and a data table with the patients and feature and their risk assessment.

***Example***
```{r, eval=FALSE}
inputData <- prepareData(data, firstFeature, featureList)
pHigh <- 0.8 
pLow <- 0.2
result <- pruneTree(inputData, pHigh, pLow)
```




## calCutOff
**Sequential training of the algorithm**  

This function is used to calculate the cutoff values for low-risk and high-risk groups. The values are calculated by the proportion between converters with a value and all patients having this certain value corresponding with the given pHigh and pLow values. For each feature cutoff calculation all patients that have not been categorized into the high or low risk categories will be used.
<br>The function requires the following arguments:

- **inputData** - The prepared input data for training of the algorithm, which is provided by pruneTree.
- **pHigh** - The high risk threshold.
- **pLow** - The low risk threshold.

The function calCutOff returns a variable fit, which contains links to the calculated cutOff table, filtered data and effectiveness of the cutOff values.

## predictTree
**Sequential prediction of a patient conversion risk**

This function calls the recursive function predictTreeRec. The function returns a variable with a link to a patient data table containing their risk assessments and a link to the average cutoff value matrix.
<br>The function requires the following arguments:

- **cutoffValues** - The calculated cutOff values, which are provided by the function calCutOff.
- **inputData** - The inputData/the patient which is supposed to be predicted (provided by pruneTree).

The function predictTree returns a variable result with its links to the cutOff matrix and predicted patient information.

## predictTreeRec
**Sequential prediction of a patient conversion risk**

This recursive function calculates the cutoff value for each parameter dependent upon the patient ratio, it also verifies if the model is effective (cut_high > cut_low).
<br>The function requires the following arguments:

- **cutoffValues** - The calculated cutOff values, which are provided by the function calCutOff.
- **inputData** - The inputData/the patient which is supposed to be predicted (provided by pruneTree).

The function predictTreeRec returns a variable result with its links to the cutOff matrix and predicted patient information.

## prepareData
**Filters and transforms given data**

The function prepareData transforms the given data into a data frame which contains only the information needed for the Triple Sec algorithm.

<br>The function requires the following arguments:

- **data** - The data which is given by the user.
- **firstFeature** - The name of column containing the feature data which is most relevant. 
- **featureList** - A list contaning all column names of the features which the algorithm is supposed to work with.


